var g=Object.defineProperty;var w=(i,e,t)=>e in i?g(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var l=(i,e,t)=>w(i,typeof e!="symbol"?e+"":e,t);class c{dispose(){}}class y{constructor(){l(this,"filters",new Map)}registerFilter(e){this.filters.set(e.name,e)}getFilter(e){return this.filters.get(e)}async applyFilters(e,t,a=[]){let s=e,r=!0;try{for(let n=0;n<t.length;n++){const h=t[n],u=this.getFilter(h);if(u){const d=a[n]||{},F=await u.apply(s,d);r||s.close(),s=F,r=!1}}return s}catch(n){return console.error("Error applying filters:",n),r||s.close(),e.clone()}}dispose(){for(const e of this.filters.values())e.dispose();this.filters.clear()}}class o extends c{constructor(){super();l(this,"name","css-filter");l(this,"canvas");l(this,"ctx");this.canvas=new OffscreenCanvas(1,1),this.ctx=this.canvas.getContext("2d")}async apply(t,a){const{filter:s=""}=a;if(!s)return t.clone();const r=t.displayWidth,n=t.displayHeight;return this.canvas.width=r,this.canvas.height=n,this.ctx.filter="none",this.ctx.drawImage(t,0,0,r,n),this.ctx.filter=s,this.ctx.drawImage(t,0,0,r,n),this.ctx.filter="none",new VideoFrame(this.canvas,{timestamp:t.timestamp,duration:t.duration||void 0})}dispose(){super.dispose(),this.canvas.width=0,this.canvas.height=0}}class f extends c{constructor(){super(...arguments);l(this,"name","grayscale")}async apply(t,a){const s=new o,r=await s.apply(t,{filter:`grayscale(${a.amount||0}%)`});return s.dispose(),r}}class m extends c{constructor(){super(...arguments);l(this,"name","blur")}async apply(t,a){const s=new o,r=await s.apply(t,{filter:`blur(${a.amount/100*5}px)`});return s.dispose(),r}}class x extends c{constructor(){super(...arguments);l(this,"name","brightness")}async apply(t,a){const s=new o,r=await s.apply(t,{filter:`brightness(${a.amount||0}%)`});return s.dispose(),r}}class v extends c{constructor(){super(...arguments);l(this,"name","contrast")}async apply(t,a){const s=new o,r=await s.apply(t,{filter:`contrast(${a.amount||0}%)`});return s.dispose(),r}}class $ extends c{constructor(){super(...arguments);l(this,"name","saturate")}async apply(t,a){const s=new o,r=await s.apply(t,{filter:`saturate(${a.amount||200}%)`});return s.dispose(),r}}const p=new y;p.registerFilter(new o);p.registerFilter(new f);p.registerFilter(new m);p.registerFilter(new x);p.registerFilter(new v);p.registerFilter(new $);export{c as BaseFilter,y as FilterManager,p as filterManager};
//# sourceMappingURL=index-Dp5EZbji.js.map
